---
title: "Everything"
author: "morgan moyer"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(lme4)
library(lmerTest)
library(multcomp) # not available for this version of R
library(stringr)
library(textstem)
library(tidyverse)
library(kableExtra)
theme_set(theme_bw())
library(ggrepel)
cbPalette <- c("#56B4E9", "#D55E00", "#009E73","#999999", "#E69F00")
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
source("../../helpers.R")

# v1 <- read_csv("../../01_verbs/exploratory_all_data/data/processed.csv")
# v1["Category"] <- "Verbs"

v <- read_csv("../../01_concreteness/01_verbs/data/processed.csv")
v["Category"] <- "Verbs"
v["Experiment"] <- "Ex1a: Conc-Abs (Verbs)"

n <- read_csv("../../01_concreteness/02_nouns/data/processed.csv")
n["Category"] <- "Nouns"
n["Experiment"] <- "Ex1b: Conc-Abs (Nouns)"

a <- read_csv("../../01_concreteness/03_adjectives/data/processed.csv")
a["Category"] <- "Adjs"
a["Experiment"] <- "Ex1c: Conc-Abs (Adjs)"

a2 <- read_csv("../../06_soc-phys/00_pilot/data/processed.csv")
a2["Category"] <- "Adjs"
a2["Experiment"] <- "Ex2b: Phys-Soc (Verbs)"

v2 <- read_csv("../../02_phys-psych/01_experiment/data/processed.csv")
v2["Category"] <- "Verbs"
v2["Experiment"] <- "Ex2a: Phys-Psych (Adjs)"


n2 <- read_csv("../../04_animacy/data/processed.csv")
n2["Category"] <- "Nouns"
n2["Experiment"] <- "Ex3: Animacy (Nouns)"

s <- read_csv("../../05_syntactic/01_experiment/data/processed.csv")
s["Experiment"] <- "Ex4: Syntactic (N v. V)"



d <- bind_rows(v,n,a,a2,v2,n2,s)

```


# Experiment 1a: Conc Abs (verbs)

```{r}
names(v)

v <- v %>%
  separate(ConcValCombo, into = c("Concreteness", "Valence"), sep = "-")

names(v)
```

## Aggregate

# Aggregate Valence

```{r}
val <- v %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 10, hjust = 1)) +
  guides(fill = "none")

ggsave("../graphs/exp1a_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- v %>% 
  filter(Task == "Concrete") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Concreteness) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("abstract", "concrete"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropConcrete = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropConcrete - CILow, 
         YMax = PropConcrete + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Concreteness <- factor(conc$Concreteness, levels = c("abstract", "concrete"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "abstract" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "concrete" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=Concreteness,y=PropConcrete,fill=Concreteness)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp1a_responses_agg_concp_paper.jpg",width = 2, height = 2)
```

## by-item

```{r}

val <- v %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  labs(x = "Word") +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))

  theme(
    legend.position = "top",
    legend.direction = "horizontal", 
    axis.text.x = element_text(angle = 90, hjust  = 1))
    # plot.margin = margin(10, 20, 20, 10)  # top, right, bottom, left (in pts)

  
  # guides(fill = "none")

ggsave("../graphs/exp1a_responses_val_paper.jpg",width = 5, height = 2)
```


```{r}

conc <- v %>% 
  filter(Task == "Concrete") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Concreteness) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("abstract", "concrete"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropConcrete = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropConcrete - CILow, 
         YMax = PropConcrete + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Concreteness <- factor(conc$Concreteness, levels = c("abstract", "concrete"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "abstract" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "concrete" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropConcrete),y=PropConcrete,fill=Concreteness)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1a_responses_concept_paper.jpg",width = 6, height = 3)
```



# Experiment 1b: Conc Abs (Nouns)

```{r}
names(n)

n <- n %>%
  separate(ConcValCombo, into = c("Concreteness", "Valence"), sep = "-")

names(n)
```

## Aggregate Valence

```{r}
val <- n %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp1b_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- n %>% 
  filter(Task == "Concrete") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Concreteness) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("abstract", "concrete"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropConcrete = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropConcrete - CILow, 
         YMax = PropConcrete + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Concreteness <- factor(conc$Concreteness, levels = c("abstract", "concrete"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "abstract" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "concrete" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=Concreteness,y=PropConcrete,fill=Concreteness)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp1b_responses_agg_concp_paper.jpg",width = 2, height = 2)
```

## By-item

```{r}

val <- n %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_val_paper.jpg",width = 6, height = 3)
```


```{r}

conc <- n %>% 
  filter(Task == "Concrete") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Concreteness) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("abstract", "concrete"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropConcrete = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropConcrete - CILow, 
         YMax = PropConcrete + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Concreteness <- factor(conc$Concreteness, levels = c("abstract", "concrete"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "abstract" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "concrete" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropConcrete),y=PropConcrete,fill=Concreteness)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_concept_paper.jpg",width = 6, height = 3)
```



# Experiment 1c: Conc Abs (Adjs)

```{r}
names(a)

a <- a %>%
  separate(ConcValCombo, into = c("Concreteness", "Valence"), sep = "-")

names(a)
```

## Aggregate Valence

```{r}
val <- a %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp1c_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- a %>% 
  filter(Task == "Concrete") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Concreteness) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("abstract", "concrete"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropConcrete = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropConcrete - CILow, 
         YMax = PropConcrete + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Concreteness <- factor(conc$Concreteness, levels = c("abstract", "concrete"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "abstract" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "concrete" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=Concreteness,y=PropConcrete,fill=Concreteness)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp1c_responses_agg_concp_paper.jpg",width = 2, height = 2)
```


```{r}

val <- a %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

ggsave("../graphs/exp1c_responses_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- a %>% 
  filter(Task == "Concrete") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Concreteness) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("abstract", "concrete"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropConcrete = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropConcrete - CILow, 
         YMax = PropConcrete + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Concreteness <- factor(conc$Concreteness, levels = c("abstract", "concrete"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "abstract" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "concrete" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropConcrete),y=PropConcrete,fill=Concreteness)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

ggsave("../graphs/exp1c_responses_concp_paper.jpg",width = 2, height = 2)
```


# Experiment 2a: Phys vs. Psych

```{r}
names(v2)

v2 <- v2 %>%
  separate(ConcValCombo, into = c("PhysPsych", "Valence"), sep = "-")

names(a)
```

## Aggregate Valence

```{r}
val <- v2 %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp2a_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- v2 %>% 
  filter(Task == "PhysPsych") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(PhysPsych) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("psychological", "physical"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPhysical = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPhysical - CILow, 
         YMax = PropPhysical + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$PhysPsych <- factor(conc$PhysPsych, levels = c("psychological", "physical"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "psychological" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "physical" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=PhysPsych,y=PropPhysical,fill=PhysPsych)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp2a_responses_agg_concp_paper.jpg",width = 2, height = 2)
```

## By-item

```{r}

val <- v2 %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1c_responses_val_paper.jpg",width = 6, height = 3)
```


```{r}

conc <- v2 %>% 
  filter(Task == "PhysPsych") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,PhysPsych) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("psychological", "physical"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPhysical = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPhysical - CILow, 
         YMax = PropPhysical + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$PhysPsych <- factor(conc$PhysPsych, levels = c("psychological", "physical"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "psychological" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "physical" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropPhysical),y=PropPhysical,fill=PhysPsych)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1c_responses_concept_paper.jpg",width = 6, height = 3)
```



# Experiment 2b: Phys vs. Soc

## Subset pilot results
```{r}

names(a2)
# Step 1: Summarize per ID.Ibex
ids_valence_only <- a2 %>%
  group_by(ID.true) %>%
  summarise(
    has_valence = any(Task == "Valence"),
    has_socphys = any(Task == "SocPhys"),
    .groups = "drop"
  ) %>%
  filter(has_valence & !has_socphys) %>%
  pull(ID.true)
```


```{r}
names(a2)

a2 <- a2 %>%
  separate(ConcValCombo, into = c("PhysSoc", "Valence"), sep = "-")

a2$Task <- as.factor(a2$Task)
levels(a2$Task)
names(a2)
```

## Aggregate Valence

```{r}
val <- a2 %>% 
  filter(Task == "Valence") %>% 
  filter(!ID.true %in% ids_valence_only) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp2b_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- a2 %>% 
  filter(Task == "SocPhys") %>% 
  filter(!ID.true %in% ids_valence_only) %>% 
  group_by(PhysSoc) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("social", "physical"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPhysical = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPhysical - CILow, 
         YMax = PropPhysical + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$PhysSoc <- factor(conc$PhysSoc, levels = c("social", "physical"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "social" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "physical" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=PhysSoc,y=PropPhysical,fill=PhysSoc)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp2b_responses_agg_concp_paper.jpg",width = 2, height = 2)
```

## By-item

```{r}

val <- n %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_val_paper.jpg",width = 6, height = 3)
```


```{r}

conc <- a2 %>% 
  filter(Task == "SocPhys") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,PhysSoc) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("social", "physical"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPhysical = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPhysical - CILow, 
         YMax = PropPhysical + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$PhysSoc <- factor(conc$PhysSoc, levels = c("social", "physical"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "social" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "physical" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropPhysical),y=PropPhysical,fill=PhysSoc)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_concept_paper.jpg",width = 6, height = 3)
```



# Experiment 3: Animacy

```{r}
names(n2)

```

## Aggregate Valence

```{r}
val <- n2 %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp3_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- n2 %>% 
  filter(Task == "Animacy") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Animacy) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("inanimate", "animate"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropAnimate = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropAnimate - CILow, 
         YMax = PropAnimate + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Animacy <- factor(conc$Animacy, levels = c("inanimate", "animate"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "inanimate" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "animate" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=Animacy,y=PropAnimate,fill=Animacy)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp3_responses_agg_concp_paper.jpg", width = 2, height = 2)
```

## By-item

```{r}

val <- n2 %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_val_paper.jpg",width = 6, height = 3)
```


```{r}

conc <- n2 %>% 
  filter(Task == "Animacy") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Animacy) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("inanimate", "animate"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropAnimate = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropAnimate - CILow, 
         YMax = PropAnimate + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Animacy <- factor(conc$Animacy, levels = c("inanimate", "animate"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "inanimate" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "animate" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropAnimate),y=PropAnimate,fill=Animacy)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_concept_paper.jpg",width = 6, height = 3)
```



# Experiment 4: Syntax


```{r}
names(s)

s <- s %>%
  separate(ConcValCombo, into = c("Syntax", "Valence"), sep = "-") %>% 
  mutate(
    Category = tolower(Category),                      # convert to lowercase
    Category = factor(Category),                       # ensure it's a factor
    Category = fct_recode(Category, noun = "nouns")    # rename level
  )

# s$Category <- tolower(s$Category)

names(s)
```

## Aggregate Valence

```{r}
val <- s %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=Valence,y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp4_responses_agg_val_paper.jpg",width = 2, height = 2)
```


```{r}

conc <- s %>% 
  filter(Task == "Syntactic") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Category) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("noun", "verb"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropVerb = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropVerb - CILow, 
         YMax = PropVerb + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Category <- factor(conc$Category, levels = c("noun", "verb"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "noun" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "verb" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=Category,y=PropVerb,fill=Category)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))
  guides(fill = "none")

ggsave("../graphs/exp4_responses_agg_concp_paper.jpg",width = 2, height = 2)
```

## By-item

```{r}

val <- n %>% 
  filter(Task == "Valence") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Valence) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("negative", "positive"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropPositive = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropPositive - CILow, 
         YMax = PropPositive + CIHigh)
  # filter(PropPositive > .1 | PropPositive < .9)

# Manuall set graph colors
val$Valence <- factor(val$Valence, levels = c("negative", "positive"))
# Define fill colors: full color and alpha-lightened version
valence_colors <- c(
  "negative" = adjustcolor("#00BFC4", alpha.f = 0.4),  # lighter via alpha
  "positive" = "#00BFC4"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=val, aes(x=reorder(Word,PropPositive),y=PropPositive,fill=Valence)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = valence_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_val_paper.jpg",width = 6, height = 3)
```


```{r}

conc <- s %>% 
  filter(Task == "Syntactic") %>% 
  # filter(Word %in% conc$Word) %>% 
  group_by(Word,Category) %>%
  mutate(Response.n = as.numeric(factor(Response, levels = c("noun", "verb"))) - 1) %>%  # Convert to numeric and subtract 1
  reframe(PropVerb = mean(Response.n),
          CILow = ci.low(Response.n), 
          CIHigh = ci.high(Response.n)) %>%
  mutate(YMin = PropVerb - CILow, 
         YMax = PropVerb + CIHigh)
  

# Manuall set graph colors
# Ensure consistent factor level order
conc$Category <- factor(conc$Category, levels = c("noun", "verb"))
# Define fill colors: full color and alpha-lightened version
concept_colors <- c(
  "noun" = adjustcolor("#F8766D", alpha.f = 0.4),  # lighter via alpha
  "verb" = "#F8766D"                               # full color
)

dodge = position_dodge(.9)
ggplot(data=conc, aes(x=reorder(Word,PropVerb),y=PropVerb,fill=Category)) +
  geom_bar(position=dodge,stat="identity",color = "black") +
  geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.25,position=position_dodge(0.9)) +
  scale_fill_manual(values = concept_colors) +
  ylim(0,1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  # guides(fill = "none")

# ggsave("../graphs/exp1b_responses_concept_paper.jpg",width = 6, height = 3)
```